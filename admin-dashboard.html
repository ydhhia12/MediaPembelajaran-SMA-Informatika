<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <title>Admin Dashboard Media Pembelajaran</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Poppins:wght@400;600&display=swap');

    body {
      font-family: 'Poppins', sans-serif;
      max-width: 1000px;
      margin: 30px auto;
      background: #2c3e50;
      color: #ecf0f1;
      padding: 20px;
      border-radius: 12px;
      box-shadow: 0 12px 30px rgba(0,0,0,0.4);
    }

    h1 {
      text-align: center;
      margin-bottom: 30px;
      font-weight: 700;
      color: #ecdbff;
    }

    nav {
      display: flex;
      justify-content: center;
      gap: 20px;
      margin-bottom: 25px;
    }

    nav button {
      padding: 12px 25px;
      background: #34495e;
      border: none;
      color: #ecf0f1;
      border-radius: 12px;
      cursor: pointer;
      font-weight: 600;
      transition: background 0.3s ease;
    }

    nav button:hover {
      background: #5d6d7e;
    }

    section {
      background: #34495e;
      padding: 20px 25px;
      border-radius: 14px;
      box-shadow: 0 8px 20px rgba(0,0,0,0.3);
      margin-bottom: 40px;
      display: none;
    }

    section.active {
      display: block;
    }

    label {
      display: block;
      margin-top: 12px;
      font-weight: 600;
    }

    input[type="text"], input[type="password"], input[type="number"], select, textarea {
      width: 100%;
      padding: 10px 12px;
      margin-top: 6px;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
      outline: none;
    }

    textarea {
      resize: vertical;
      min-height: 70px;
    }

    button.submit-btn {
      margin-top: 20px;
      padding: 14px 0;
      width: 100%;
      background: #6c5ce7;
      border: none;
      border-radius: 14px;
      font-weight: 700;
      color: white;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(108,92,231,0.6);
      transition: background 0.3s ease;
    }

    button.submit-btn:hover {
      background: #4834d4;
    }

    table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0 10px;
      margin-top: 20px;
      color: #ecf0f1;
    }

    th, td {
      padding: 12px 15px;
      text-align: left;
      vertical-align: middle;
    }

    thead th {
      background: #6c5ce7;
      font-weight: 700;
      border-radius: 10px;
    }

    tbody tr {
      background: #3c4a63;
      border-radius: 10px;
      box-shadow: 0 3px 8px rgba(0,0,0,0.15);
    }

    tbody tr td:first-child {
      font-weight: 600;
    }

    button.delete-btn, button.edit-btn {
      background: #e17055;
      color: white;
      border: none;
      padding: 6px 14px;
      border-radius: 10px;
      cursor: pointer;
      font-weight: 600;
      margin-right: 8px;
      transition: background 0.3s ease;
    }

    button.delete-btn:hover {
      background: #d63031;
    }

    button.edit-btn:hover {
      background: #fdcb6e;
      color: #2d3436;
    }

    .score-badge {
      background: #00b894;
      padding: 4px 10px;
      border-radius: 12px;
      font-weight: 700;
      font-size: 0.9rem;
      color: white;
      display: inline-block;
    }

    .score-input {
      width: 60px;
      padding: 6px 8px;
      border-radius: 8px;
      border: none;
      font-size: 1rem;
      outline: none;
    }

  </style>
</head>
<body>

  <h1>Admin Dashboard Media Pembelajaran</h1>

  <nav>
    <button onclick="showSection('akun')">üë• Kelola Akun Siswa</button>
    <button onclick="showSection('soal')">üìù Kelola Soal Kuis</button>
    <button onclick="showSection('nilai')">üìä Rekap Nilai Siswa</button>
  </nav>

  <!-- Akun Siswa -->
  <section id="akun" class="active">
    <h2>Kelola Akun Siswa</h2>
    <form id="formAkun">
      <label>Username</label>
      <input type="text" id="username" placeholder="Username unik" required />
      <label>Nama Lengkap</label>
      <input type="text" id="nama" placeholder="Nama siswa" required />
      <label>Password</label>
      <input type="password" id="password" placeholder="Password" required />
      <label>Kelas</label>
      <select id="kelas" required>
        <option value="">-- Pilih Kelas --</option>
        <option value="10">Kelas 10</option>
        <option value="11">Kelas 11</option>
        <option value="12">Kelas 12</option>
      </select>
      <button type="submit" class="submit-btn">Tambah / Update Akun</button>
    </form>

    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Nama Lengkap</th>
          <th>Kelas</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="akunList"></tbody>
    </table>
  </section>

  <!-- Kelola Soal -->
  <section id="soal">
    <h2>Kelola Soal Kuis</h2>
    <form id="formSoal">
      <label>Soal</label>
      <textarea id="soalText" placeholder="Tulis soal..." required></textarea>
      <label>Jenis Soal</label>
      <select id="jenisSoal" required>
        <option value="">-- Pilih Jenis Soal --</option>
        <option value="pg">Pilihan Ganda</option>
        <option value="esai">Esai</option>
      </select>
      <div id="pgOptions" style="display:none; margin-top:10px;">
        <label>Opsi Jawaban:</label>
        <input type="text" id="optionA" placeholder="Pilihan A" required />
        <input type="text" id="optionB" placeholder="Pilihan B" required />
        <input type="text" id="optionC" placeholder="Pilihan C" required />
        <input type="text" id="optionD" placeholder="Pilihan D" required />
        <input type="text" id="optionE" placeholder="Pilihan E" required />
        <label>Jawaban Benar</label>
        <select id="jawabanBenar" required>
          <option value="">-- Pilih Jawaban Benar --</option>
          <option value="A">A</option>
          <option value="B">B</option>
          <option value="C">C</option>
          <option value="D">D</option>
          <option value="E">E</option>
        </select>
      </div>
      <label>Bab (Judul Materi)</label>
      <input type="text" id="babSoal" placeholder="Misal: Bab 1 Jaringan Komputer" required />
      <label>Kelas</label>
      <select id="kelasSoal" required>
        <option value="">-- Pilih Kelas --</option>
        <option value="10">Kelas 10</option>
        <option value="11">Kelas 11</option>
        <option value="12">Kelas 12</option>
      </select>
      <label>Semester</label>
      <select id="semesterSoal" required>
        <option value="">-- Pilih Semester --</option>
        <option value="1">Semester 1</option>
        <option value="2">Semester 2</option>
      </select>
      <button type="submit" class="submit-btn">Tambah Soal</button>
    </form>

    <table>
      <thead>
        <tr>
          <th>Soal</th>
          <th>Jenis</th>
          <th>Bab</th>
          <th>Kelas</th>
          <th>Semester</th>
          <th>Jawaban Benar</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="soalList"></tbody>
    </table>
  </section>

  <!-- Rekap Nilai -->
  <section id="nilai">
    <h2>Rekap Nilai Siswa</h2>

    <table>
      <thead>
        <tr>
          <th>Username</th>
          <th>Nama Lengkap</th>
          <th>Kelas</th>
          <th>Bab</th>
          <th>Semester</th>
          <th>Jenis Soal</th>
          <th>Nilai</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody id="nilaiList"></tbody>
    </table>
  </section>

<script>
  // Tampilkan section sesuai tombol
  function showSection(id) {
    ['akun', 'soal', 'nilai'].forEach(s => {
      document.getElementById(s).classList.toggle('active', s === id);
    });
  }

  // --- DATA HANDLING ---

  // Simpan data di localStorage
  function saveData(key, data) {
    localStorage.setItem(key, JSON.stringify(data));
  }
  // Ambil data dari localStorage
  function getData(key) {
    return JSON.parse(localStorage.getItem(key)) || [];
  }

  // --- KELOLA AKUN ---

  const formAkun = document.getElementById('formAkun');
  const akunList = document.getElementById('akunList');

  function renderAkun() {
    const users = getData('users');
    akunList.innerHTML = '';
    users.forEach((user, i) => {
      akunList.innerHTML += `
        <tr>
          <td>${user.username}</td>
          <td>${user.nama}</td>
          <td>${user.kelas}</td>
          <td>
            <button class="edit-btn" data-index="${i}">Edit</button>
            <button class="delete-btn" data-index="${i}">Hapus</button>
          </td>
        </tr>`;
    });
    // Event tombol hapus
    document.querySelectorAll('.delete-btn').forEach(btn => {
      btn.onclick = e => {
        const idx = e.target.getAttribute('data-index');
        if(confirm('Hapus akun ini?')) {
          let users = getData('users');
          users.splice(idx,1);
          saveData('users', users);
          renderAkun();
        }
      }
    });
    // Event tombol edit
    document.querySelectorAll('.edit-btn').forEach(btn => {
      btn.onclick = e => {
        const idx = e.target.getAttribute('data-index');
        const users = getData('users');
        const user = users[idx];
        document.getElementById('username').value = user.username;
        document.getElementById('nama').value = user.nama;
        document.getElementById('password').value = user.password;
        document.getElementById('kelas').value = user.kelas;
      }
    });
  }

  formAkun.addEventListener('submit', e => {
    e.preventDefault();
    const username = document.getElementById('username').value.trim();
    const nama = document.getElementById('nama').value.trim();
    const password = document.getElementById('password').value;
    const kelas = document.getElementById('kelas').value;

    if(!username || !nama || !password || !kelas){
      alert('Semua field harus diisi!');
      return;
    }

    let users = getData('users');
    const existIndex = users.findIndex(u => u.username === username);
    if(existIndex >= 0) {
      // Update akun
      users[existIndex] = {username, nama, password, kelas};
    } else {
      // Tambah akun baru
      users.push({username, nama, password, kelas});
    }
    saveData('users', users);
    renderAkun();
    formAkun.reset();
  });

  renderAkun();

  // --- KELOLA SOAL ---

  const formSoal = document.getElementById('formSoal');
  const soalList = document.getElementById('soalList');
  const jenisSoalSelect = document.getElementById('jenisSoal');
  const pgOptionsDiv = document.getElementById('pgOptions');

  jenisSoalSelect.addEventListener('change', () => {
    if(jenisSoalSelect.value === 'pg') {
      pgOptionsDiv.style.display = 'block';
      document.querySelectorAll('#pgOptions input, #pgOptions select').forEach(el => el.required = true);
    } else {
      pgOptionsDiv.style.display = 'none';
      document.querySelectorAll('#pgOptions input, #pgOptions select').forEach(el => el.required = false);
    }
  });

  function renderSoal() {
    const soalData = getData('soal');
    soalList.innerHTML = '';
    soalData.forEach((item, i) => {
      soalList.innerHTML += `
        <tr>
          <td>${item.soal}</td>
          <td>${item.jenis}</td>
          <td>${item.bab}</td>
          <td>${item.kelas}</td>
          <td>${item.semester}</td>
          <td>${item.jenis === 'pg' ? item.jawabanBenar : '-'}</td>
          <td>
            <button class="delete-btn" data-index="${i}">Hapus</button>
          </td>
        </tr>
      `;
    });
    // Event hapus soal
    document.querySelectorAll('#soalList .delete-btn').forEach(btn => {
      btn.onclick = e => {
        const idx = e.target.getAttribute('data-index');
        if(confirm('Hapus soal ini?')) {
          let soalData = getData('soal');
          soalData.splice(idx,1);
          saveData('soal', soalData);
          renderSoal();
        }
      }
    });
  }

  formSoal.addEventListener('submit', e => {
    e.preventDefault();
    const soalText = document.getElementById('soalText').value.trim();
    const jenis = document.getElementById('jenisSoal').value;
    const bab = document.getElementById('babSoal').value.trim();
    const kelas = document.getElementById('kelasSoal').value;
    const semester = document.getElementById('semesterSoal').value;

    if(!soalText || !jenis || !bab || !kelas || !semester){
      alert('Semua field harus diisi!');
      return;
    }

    let newSoal = {
      soal: soalText,
      jenis,
      bab,
      kelas,
      semester,
    };

    if(jenis === 'pg') {
      // Validasi opsi PG dan jawaban benar
      const optionA = document.getElementById('optionA').value.trim();
      const optionB = document.getElementById('optionB').value.trim();
      const optionC = document.getElementById('optionC').value.trim();
      const optionD = document.getElementById('optionD').value.trim();
      const optionE = document.getElementById('optionE').value.trim();
      const jawabanBenar = document.getElementById('jawabanBenar').value;

      if(!optionA || !optionB || !optionC || !optionD || !optionE || !jawabanBenar) {
        alert('Semua opsi dan jawaban benar harus diisi untuk soal PG.');
        return;
      }

      newSoal.opsi = {
        A: optionA,
        B: optionB,
        C: optionC,
        D: optionD,
        E: optionE
      };
      newSoal.jawabanBenar = jawabanBenar;
    }

    // Simpan soal baru
    let soalData = getData('soal');
    soalData.push(newSoal);
    saveData('soal', soalData);
    renderSoal();
    formSoal.reset();
    pgOptionsDiv.style.display = 'none';
  });

  renderSoal();

  // --- REKAP NILAI ---

  // Ambil data nilai dari localStorage
  // Nilai disimpan format:
  // [{ username, nama, kelas, bab, semester, jenisSoal, nilai, status: 'pg'/'esai', nilaiEsai: null }]

  const nilaiList = document.getElementById('nilaiList');

  function renderNilai() {
    const nilaiData = getData('nilai');
    nilaiList.innerHTML = '';

    if(nilaiData.length === 0) {
      nilaiList.innerHTML = `<tr><td colspan="8" style="text-align:center; color:#bbb;">Belum ada data nilai</td></tr>`;
      return;
    }

    nilaiData.forEach((item, i) => {
      let nilaiDisplay = item.status === 'pg' ? 
        `<span class="score-badge">${item.nilai}</span>` : 
        item.nilaiEsai !== null ? `<span class="score-badge">${item.nilaiEsai}</span>` : `<input type="number" min="0" max="100" class="score-input" data-index="${i}" value="" placeholder="Nilai Esai" />`;

      let aksiBtn = item.status === 'esai' && item.nilaiEsai === null ? 
        `<button class="submit-btn" data-index="${i}">Simpan Nilai</button>` : '';

      nilaiList.innerHTML += `
        <tr>
          <td>${item.username}</td>
          <td>${item.nama}</td>
          <td>${item.kelas}</td>
          <td>${item.bab}</td>
          <td>${item.semester}</td>
          <td>${item.jenisSoal.toUpperCase()}</td>
          <td>${nilaiDisplay}</td>
          <td>${aksiBtn}</td>
        </tr>
      `;
    });

    // Event simpan nilai esai
    document.querySelectorAll('#nilaiList button.submit-btn').forEach(btn => {
      btn.onclick = e => {
        const idx = e.target.getAttribute('data-index');
        const inputNilai = document.querySelector(`#nilaiList input.score-input[data-index="${idx}"]`);
        const val = inputNilai.value.trim();
        if(val === '' || isNaN(val) || val < 0 || val > 100) {
          alert('Masukkan nilai esai valid antara 0-100');
          return;
        }
        let nilaiData = getData('nilai');
        nilaiData[idx].nilaiEsai = Number(val);
        saveData('nilai', nilaiData);
        renderNilai();
      }
    });
  }

  renderNilai();

</script>

</body>
</html>










